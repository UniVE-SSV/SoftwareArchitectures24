<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
		<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Example - log4j | Software Architectures</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Example - log4j" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Contents" />
<meta property="og:description" content="Contents" />
<link rel="canonical" href="http://localhost:4000/gradle/example-log4j/" />
<meta property="og:url" content="http://localhost:4000/gradle/example-log4j/" />
<meta property="og:site_name" content="Software Architectures" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-24T10:25:55+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Example - log4j" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Article","dateModified":"2024-09-24T10:25:55+00:00","datePublished":"2024-09-24T10:25:55+00:00","description":"Contents","headline":"Example - log4j","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"url":"http://localhost:4000/gradle/example-log4j/"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Software Architectures" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700|Roboto:ital,wght@0,100;1,100&display=swap">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		<!-- -->
	</head>

	<body>
		<header>
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="Software Architectures logo"></a>
				Software Architectures
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav >
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/">Home</a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level current">
							
							<a href="/gradle/introduction/">02. Gradle</a>
							<ul>
								
									<li class="nav-item "><a href="/gradle/introduction/">1. Introduction</a></li>
								
									<li class="nav-item "><a href="/gradle/build.gradle/">2. build.gradle</a></li>
								
									<li class="nav-item "><a href="/gradle/testing-java-applications/">3. Testing Java Applications</a></li>
								
									<li class="nav-item current"><a href="/gradle/example-log4j/">4. Example - log4j</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/docker/introduction/">1. Docker</a>
							<ul>
								
									<li class="nav-item "><a href="/docker/introduction/">1. Introduction</a></li>
								
									<li class="nav-item "><a href="/docker/getting-started/">2. Getting Started</a></li>
								
									<li class="nav-item "><a href="/docker/cli-and-dockerfile/">3. CLI and Dockerfile</a></li>
								
									<li class="nav-item "><a href="/docker/volumes/">4. Volumes</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/"></a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>02. Gradle</h2>
				<h3>4. Example - log4j</h3>
			</div>
			<article class="content">
				<h2>Contents</h2>
<ul id="markdown-toc">
  <li><a href="#logging" id="markdown-toc-logging">Logging</a></li>
  <li><a href="#log-level" id="markdown-toc-log-level">Log level</a></li>
  <li><a href="#exercises" id="markdown-toc-exercises">Exercises</a></li>
</ul>

<p>Here, we will see an example of how we can add a dependency to our Gradle project. For this purpose, we will present a Java logging library, <a target="_blank" rel="noopener noreferrer" href="https://logging.apache.org/log4j/2.x/">Log4j</a>.</p>
<h2 id="logging">Logging</h2>
<p>When you write software, it is useful to introduce logs. Logs can help, for example, to record the execution of events in your application, to identify and understand the pattern of activities, and to identify the source of problems in case of software incidents.<br />
Log4j is a library that enhances the main logging mechanism of Java. To use Log4J in a Java Gradle project, we follow what the <a target="_blank" rel="noopener noreferrer" href="https://logging.apache.org/log4j/2.x/maven-artifacts.html">documentation</a> says and we add the dependencies. Our build.gradle file should look like this:</p>

<figure class="highlight"><pre><code class="language-kotlin" data-lang="kotlin"><span class="nf">plugins</span> <span class="p">{</span>
    <span class="nf">id</span><span class="p">(</span><span class="s">"application"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">group</span> <span class="p">=</span> <span class="s">"org.example"</span>
<span class="n">version</span> <span class="p">=</span> <span class="s">"1.0-SNAPSHOT"</span>

<span class="nf">repositories</span> <span class="p">{</span>
    <span class="nf">mavenCentral</span><span class="p">()</span>
<span class="p">}</span>

<span class="nf">dependencies</span> <span class="p">{</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.apache.logging.log4j:log4j-api:2.20.0"</span><span class="p">)</span>
    <span class="nf">implementation</span><span class="p">(</span><span class="s">"org.apache.logging.log4j:log4j-core:2.20.0"</span><span class="p">)</span>
    <span class="nf">testImplementation</span><span class="p">(</span><span class="s">"org.junit.jupiter:junit-jupiter-api:5.9.0"</span><span class="p">)</span>
    <span class="nf">testRuntimeOnly</span><span class="p">(</span><span class="s">"org.junit.jupiter:junit-jupiter-engine:5.9.0"</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">application</span> <span class="p">{</span>
    <span class="n">mainClass</span><span class="p">.</span><span class="k">set</span><span class="p">(</span><span class="s">"org.example.Main"</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">tasks</span><span class="p">.</span><span class="nf">test</span> <span class="p">{</span>
    <span class="nf">useJUnitPlatform</span><span class="p">()</span>
<span class="p">}</span></code></pre></figure>

<p>Then, we can just start using the log4j library directly on our application:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.LogManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.Logger</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"Main"</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">addExact</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// int a = Integer.parseInt(args[0]);</span>
        <span class="c1">// int b = Integer.parseInt(args[1]);</span>
        <span class="c1">// int result = Main.add(a, b);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>However, nothing is printed out in the console. This is because we need to configure the log4J library. To do so, create a file in /src/main/resources, named “log4js2.xml”, with this content:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">"1.0"</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="o">?&gt;</span>
<span class="o">&lt;</span><span class="nc">Configuration</span> <span class="n">status</span><span class="o">=</span><span class="s">"INFO"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nc">Appenders</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nc">Console</span> <span class="n">name</span><span class="o">=</span><span class="s">"Console"</span> <span class="n">target</span><span class="o">=</span><span class="s">"SYSTEM_OUT"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nc">PatternLayout</span> <span class="n">pattern</span><span class="o">=</span><span class="s">"%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"</span> <span class="o">/&gt;</span>
        <span class="o">&lt;/</span><span class="nc">Console</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nc">File</span> <span class="n">name</span><span class="o">=</span><span class="s">"File"</span> <span class="n">fileName</span><span class="o">=</span><span class="s">"./logs/log.log"</span> <span class="n">immediateFlush</span><span class="o">=</span><span class="s">"false"</span> <span class="n">append</span><span class="o">=</span><span class="s">"false"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nc">PatternLayout</span> <span class="n">pattern</span><span class="o">=</span><span class="s">"%d{yyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"</span><span class="o">/&gt;</span>
        <span class="o">&lt;/</span><span class="nc">File</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nc">Appenders</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nc">Loggers</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nc">Root</span> <span class="n">level</span><span class="o">=</span><span class="s">"debug"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="nc">AppenderRef</span> <span class="n">ref</span><span class="o">=</span><span class="s">"Console"</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="nc">AppenderRef</span> <span class="n">ref</span><span class="o">=</span><span class="s">"File"</span><span class="o">/&gt;</span>
        <span class="o">&lt;/</span><span class="nc">Root</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="nc">Loggers</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="nc">Configuration</span><span class="o">&gt;</span></code></pre></figure>

<p><a target="_blank" rel="noopener noreferrer" href="https://logging.apache.org/log4j/2.x/manual/configuration.html">Here</a> you can find additional information. Our configuration file tells log4j to log file in the console and in a file in folder /logs/log.log. Check it out!</p>

<h2 id="log-level">Log level</h2>
<p>You can classify logs based on their importance. You can do this by using the log level. A high log level means that the logged information is more important than a lower one and requires particular attention. Usually, a high level reports fatal errors and errors in general. Here are what log level log4j offers (ordered by importance):</p>
<ol>
  <li>Fatal: tells that the application enters a state in which one of the crucial functionalities stopped working.</li>
  <li>Error: tells that one or more functionality doesn’t work properly.</li>
  <li>Warn: tells that something unexpected happens, but the application is not affected.</li>
  <li>Info: tells that something happens (for example, used to track that the application enters a certain state).</li>
  <li>Debug: in this level, you should put all the information that regards debugging.</li>
  <li>Trace: used when you need full visibility of what it is happening inside your application (for example, you can use trace to keep track of the control flow of your application).</li>
</ol>

<p>You can use log levels in the following way:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.LogManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.logging.log4j.Logger</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">LogManager</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="s">"Main"</span><span class="o">);</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">add</span><span class="o">(</span><span class="kt">int</span> <span class="n">a</span><span class="o">,</span> <span class="kt">int</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">addExact</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// int a = Integer.parseInt(args[0]);</span>
        <span class="c1">// int b = Integer.parseInt(args[1]);</span>
        <span class="c1">// int result = Main.add(a, b);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">fatal</span><span class="o">(</span><span class="s">"Hello World from log4j"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">~/IdeaProjects/Gradle-GettingStarted ./gradlew run

<span class="o">&gt;</span> Task :run
15:45:27.762 <span class="o">[</span>main] DEBUG Main - Hello World from log4j
15:45:27.763 <span class="o">[</span>main] INFO  Main - Hello World from log4j
15:45:27.763 <span class="o">[</span>main] WARN  Main - Hello World from log4j
15:45:27.763 <span class="o">[</span>main] ERROR Main - Hello World from log4j
15:45:27.764 <span class="o">[</span>main] FATAL Main - Hello World from log4j

BUILD SUCCESSFUL <span class="k">in </span>1s
3 actionable tasks: 2 executed, 1 up-to-date
~/IdeaProjects/Gradle-GettingStarted </code></pre></figure>

<h2 id="exercises">Exercises</h2>
<ol>
  <li>Define a class Student that has a name, a surname,  a matriculation number, and a list of passed Courses. Then, write a test function that creates a Student and adds some courses to its list. Log the created Student in a log entry in JSON format using the <a target="_blank" rel="noopener noreferrer" href="https://github.com/google/gson">gson</a> library and log4j.</li>
</ol>
<div>
Previous: <a href="/SoftwareArchitectures24/gradle/testing-java-applications">Gradle - Testing Java Application</a>
</div>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});
		</script>
	</body>
</html>
